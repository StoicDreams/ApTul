/*!
 * SVG Path Rotator
 * Rotates an SVG path around a specific point.
 * Authored by Erik Gassler - Stoic Dreams
 * Copyright Â© 2026 Stoic Dreams
 * Licensed under the MIT license
 */
"use strict";webui.define("app-svg-path-rotator",{preload:"flex input-text input-message code button grid alert paper card",constructor:t=>{t.path="M0 -70Q-7 -70 -7 -70Q-7 -60 -7 -60Q-7 -45 -7 -45Q-7 -35 -7 -35Q-7 -30 -7 -30Q0 -22 0 -22Q7 -30 7 -30Q7 -35 7 -35Q7 -45 7 -45Q7 -60 7 -60Q7 -70 7 -70z",t.cx=0,t.cy=0,t.angles="0 45 90 135 180 225 270 315",t.precision=0},connected:t=>{t.render()},render:function(){const t=this;t.innerHTML="";const wrap=webui.create("webui-flex",{column:!0,gap:"var(--padding)"});t.appendChild(wrap);const card=webui.create("webui-paper",{elevation:3,padding:!0});wrap.appendChild(card);const formGrid=webui.create("webui-grid",{columns:"1fr",gap:"var(--padding)"});card.appendChild(formGrid);const pathInput=webui.create("webui-input-message",{label:"SVG Path Data",value:t.path,rows:3,placeholder:"e.g. M10 10 L50 50..."});pathInput.addEventListener("input",(e=>t.path=e.target.value)),formGrid.appendChild(pathInput);const configGrid=webui.create("webui-grid",{columns:"1fr 1fr 1fr 2fr",gap:"var(--padding)"});formGrid.appendChild(configGrid);const cxInput=webui.create("webui-input-text",{label:"Center X",value:t.cx,type:"number"});cxInput.addEventListener("input",(e=>t.cx=parseFloat(e.target.value)||0)),configGrid.appendChild(cxInput);const cyInput=webui.create("webui-input-text",{label:"Center Y",value:t.cy,type:"number"});cyInput.addEventListener("input",(e=>t.cy=parseFloat(e.target.value)||0)),configGrid.appendChild(cyInput);const precInput=webui.create("webui-input-text",{label:"Precision",value:t.precision,type:"number",min:0,max:10});precInput.addEventListener("input",(e=>t.precision=parseInt(e.target.value)||0)),configGrid.appendChild(precInput);const anglesInput=webui.create("webui-input-text",{label:"Angles (Space delimited degrees)",value:t.angles,placeholder:"0 90 180"});anglesInput.addEventListener("input",(e=>t.angles=e.target.value)),configGrid.appendChild(anglesInput);const btnRow=webui.create("webui-flex",{justify:"end"}),btn=webui.create("webui-button",{text:"Calculate Paths",theme:"primary"});btnRow.appendChild(btn),formGrid.appendChild(btnRow);const outputWrapper=webui.create("div");wrap.appendChild(outputWrapper);const buildSvg=content=>`\n                <svg viewBox="-200 -200 400 400" xmlns="http://www.w3.org/2000/svg" style="width:100%; height:300px; background:#f4f4f4; border:1px solid #ddd; border-radius:4px;">\n                    <line x1="-200" y1="0" x2="200" y2="0" stroke="#ddd" />\n                    <line x1="0" y1="-200" x2="0" y2="200" stroke="#ddd" />\n                    ${content}\n                    <circle cx="${t.cx}" cy="${t.cy}" r="3" fill="red" />\n                </svg>\n            `;btn.addEventListener("click",(async()=>{if(outputWrapper.innerHTML="",t.path)try{const result=await webui.worker.rotate_svg_path(t.path,t.cx,t.cy,t.angles,t.precision),previewGrid=webui.create("webui-grid",{columns:"1fr 1fr",gap:"var(--padding)",style:"margin-bottom: 20px;"});outputWrapper.appendChild(previewGrid);const leftCol=webui.create("div");leftCol.innerHTML='<h4 style="text-align:center;">Original</h4>'+buildSvg(`<path d="${t.path}" fill="none" stroke="black" stroke-width="2" />`),previewGrid.appendChild(leftCol);const resultPaths=result.split("\n").map(((d,i)=>`<path d="${d}" fill="none" stroke="blue" stroke-width="2" opacity="0.7" />`)).join(""),rightCol=webui.create("div");rightCol.innerHTML='<h4 style="text-align:center;">Result</h4>'+buildSvg(resultPaths),previewGrid.appendChild(rightCol);const codeBlock=webui.create("webui-code",{lang:"text",label:"Rotated Paths (One per line)"});codeBlock.setValue(result),outputWrapper.appendChild(codeBlock)}catch(err){console.error(err),outputWrapper.appendChild(webui.create("webui-alert",{theme:"danger",text:"Error processing path. Please check your SVG syntax.",show:!0}))}else outputWrapper.appendChild(webui.create("webui-alert",{theme:"warning",text:"Please enter a valid path string.",show:!0}))}))}});